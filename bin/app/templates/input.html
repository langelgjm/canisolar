<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
		<!-- TODO: write a description -->
		<meta name="description" content="">
		<meta name="author" content="Gabriel J. Michael">
		<!-- TODO: include a favicon! -->
		<link rel="icon" href="../../favicon.ico">

		<title>Can I Solar?</title>

		<!-- Bootstrap core CSS -->
		<link href="../static/css/bootstrap.min.css" rel="stylesheet">
		<!-- Custom styles for this template -->
		<link href="../static/css/starter-template.css" rel="stylesheet">
		
		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key={{data['google_maps_api_key']}}"></script>
		<script>
		function geocode() {
			geocoder = new google.maps.Geocoder();
			geocoder.geocode({ 'address': document.getElementById("address").value}, 
				function(results, status) {
				  if (status == google.maps.GeocoderStatus.OK) {
				  	var state = '';
				  	var state_name = '';
				  	var zipcode = '';
				  	var locality = '';
				  	var arrayLength = results[0].address_components.length;
				  	for (var i = 0; i < arrayLength; i++) {
						if (results[0].address_components[i].types.indexOf('administrative_area_level_1') > -1) {
							state = results[0].address_components[i].short_name;
							state_name = results[0].address_components[i].long_name;
						}
						if (results[0].address_components[i].types.indexOf('postal_code') > -1)  {
							zipcode = results[0].address_components[i].short_name;
						}						
						if (results[0].address_components[i].types.indexOf('locality') > -1)  {
							locality = results[0].address_components[i].short_name;
						}
						if (locality === '') {
							if (results[0].address_components[i].types.indexOf('administrative_area_level_2') > -1)  {
								locality = results[0].address_components[i].short_name;
							}
						}						
				  	}
					document.getElementById("lat").value = results[0].geometry.location.lat();
					document.getElementById("lng").value = results[0].geometry.location.lng();
					document.getElementById("state").value = state;
					document.getElementById("state_name").value = state_name;
					document.getElementById("locality").value = locality;
					document.getElementById("zipcode").value = zipcode;
					document.myform.action = "/output";
					document.myform.submit();	
				  } else {
				  // Write some error handling code here
				  	console.log('GeocoderStatus Not OK');
				  }
				}
			);
		}
  		</script>		
	</head>

	<body>

	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">Toggle navigation</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Can I Solar?</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav">
					<li class="active"><a href="#">Home</a></li>
					<li><a href="#about">About</a></li>
					<li><a href="#contact">Contact</a></li>
				</ul>
			</div><!--/.nav-collapse -->
		</div>
    </nav>

	<div class="container">
	
		<div class="row">
			<br><br>
			<br><br>
		</div>

		<div class="row">	
			<h4>
			Enter your address, a recent electric bill, and the month of the bill, and <b>Can I Solar</b> will tell you if a solar installation could work for you.
			</h4>
		</div>

	
	    <div class="row">
		<form id="myform"  role="form" name="myform" class="form-horizontal" onsubmit="event.preventDefault(); geocode()" action="/output" method="GET">
  			<div class="col-md-4">
				<!-- Text input-->
				<div class="form-group">
				  <label class="control-label" for="address">Address</label>
				  <div class="controls">
					<input id="address" name="address" class="form-control" required="" type="text" value="">
				  </div>
				</div>

				<!-- Text input-->
				<div class="form-group">
				  <label class="control-label" for="cost">Most Recent Bill</label>
				  <div class="controls">
					<input id="cost" name="cost" class="form-control" required="" type="text" value="">

				  </div>
				</div>

				<!-- Select Basic -->
				<div class="form-group">
				  <label class="control-label" for="month">Month of Bill</label>
				  <div class="controls">
					<select id="month" name="month" class="form-control" value ="1">
					  <option value="1">January</option>
					  <option value="2">February</option>
					  <option value="3">March</option>
					  <option value="4">April</option>
					  <option value="5">May</option>
					  <option value="6">June</option>
					  <option value="7">July</option>
					  <option value="8">August</option>
					  <option value="9">September</option>
					  <option value="10">October</option>
					  <option value="11">November</option>
					  <option value="12">December</option>
					</select>
				  </div>
				</div>

				<!-- Hidden inputs -->
				<input id="lng" name="lng" class="form-control" required="" type="hidden" value="">
				<input id="lat" name="lat" class="form-control" required="" type="hidden" value="">
				<input id="state" name="state" class="form-control" required="" type="hidden" value="">	
				<input id="state_name" name="state_name" class="form-control" required="" type="hidden" value="">	
				<input id="locality" name="locality" class="form-control" required="" type="hidden" value="">	
				<input id="zipcode" name="zipcode" class="form-control" required="" type="hidden" value="">	
				<input id="net_metering" class="form-control" type="hidden" name="net_metering" value=1>				

				<!-- Button -->
				<div class="form-group">
					<label class="control-label" for="submit"></label>
					<div class="controls">
						<button id="submitbutton" name="submitbutton" class="btn btn-primary">Can I Solar?</button>
					</div>
				</div>				  			
  			</div>
  			<div class="col-md-4"></div>
  			<div class="col-md-4"></div>
		</form>
		</div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script> -->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!--<script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
        
  </body>
</html>